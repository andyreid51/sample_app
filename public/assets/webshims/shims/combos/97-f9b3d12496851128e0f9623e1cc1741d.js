webshims.register("jmebase",function(e,t,i,n,s){"use strict";var a={},r={},o=Array.prototype.slice,l=0,d=e.extend({selector:".mediaplayer"},t.cfg.mediaelement.jme),p=d.selector;t.cfg.mediaelement.jme=d,e.jme||(e.jme={}),e.extend(e.jme,{pluginsClasses:[],pluginsSel:"",plugins:{},props:a,fns:r,data:function(t,i,n){var a=e(t).data("jme")||e.data(t,"jme",{});return n===s?i?a[i]:a:(a[i]=n,void 0)},runPlugin:function(t){l&&e(document.querySelectorAll(p)).each(function(){var i=this.querySelectorAll(t);i.length&&e(this).jmeFn("addControls",i)})},registerPlugin:function(t,i){this.plugins[t]=i,i.nodeName||(i.nodeName=""),i.className||(i.className=t),this.pluginsClasses.push("."+i.className),this.pluginsSel=this.pluginsClasses.join(", "),d[t]=e.extend(i.options||{},d[t]),d[t]&&d[t].text?i.text=d[t].text:d.i18n&&d.i18n[t]&&(i.text=d.i18n[t]),this.runPlugin("."+i.className)},configmenuPlugins:{},addToConfigmenu:function(e,t){this.configmenuPlugins[e]=t},defineMethod:function(e,t){r[e]=t},defineProp:function(t,i){i||(i={}),i.set||(i.set=i.readonly?function(){throw t+" is readonly"}:e.noop),i.get||(i.get=function(i){return e.jme.data(i,t)}),a[t]=i},prop:function(t,i,n){if(!a[i])return e.prop(t,i,n);if(n===s)return a[i].get(t);var r=a[i].set(t,n);r===s&&(r=n),"noDataSet"!=r&&e.jme.data(t,i,r)}}),e.fn.jmeProp=function(t,i){return e.access(this,e.jme.prop,t,i,arguments.length>1)},e.fn.jmeFn=function(i){var n,a=o.call(arguments,1);return this.each(function(){return e.jme.data(this).media||(e(this).closest(p).jmePlayer(),t.warn("jmeFn called to early or on wrong element!")),n=(r[i]||e.prop(this,i)).apply(this,a),n!==s?!1:void 0}),n!==s?n:this};var u={emptied:1,pause:1},c={canplay:1,canplaythrough:1};e.jme.initJME=function(t,i){l+=e(t.querySelectorAll(p)).add(i.filter(p)).jmePlayer().length},e.jme.getDOMList=function(t){var i=[];return t||(t=[]),"string"==typeof t&&(t=t.split(" ")),e.each(t,function(e,t){t&&(t=document.getElementById(t),t&&i.push(t))}),i},e.jme.getButtonText=function(t,i){var n,s,a=function(a){s!==a&&(s=a,t.removeClass(i[a?0:1]).addClass(i[a]),n&&(t.prop("checked",!!a),(t.data("checkboxradio")||{refresh:e.noop}).refresh()))};return t.is('[type="checkbox"], [type="radio"]')?(t.prop("checked",function(){return this.defaultChecked}),n=!0):t.is("a")&&t.on("click",function(e){e.preventDefault()}),a},e.fn.jmePlayer=function(){return this.each(function(){var t,i,n,s,a,r,o,l=e("audio, video",this).eq(0),p=e(this),h=e.jme.data(this),m=e.jme.data(l[0]);p.addClass(l.prop("nodeName").toLowerCase()+"player"),m.player=p,m.media=l,h.media||(o=function(){p[0].className=p[0].className},n=function(){l.off("canplay",i),clearTimeout(s)},i=function(){var e=l.prop("paused")?"idle":"playing";p.attr("data-state",e)},t=function(t){var d,h,m=t.type;n(),c[m]&&"waiting"!=a||r&&"emptied"==m||("ended"==m||e.prop(this,"ended")?m="ended":"waiting"==m?e.prop(this,"readyState")>2?m="":(s=setTimeout(function(){l.prop("readyState")>2&&i()},9),l.on("canPlay",i)):u[m]?m="idle":(d=e.prop(this,"readyState"),h=e.prop(this,"paused"),m=!h&&3>d?"waiting":!h&&d>2?"playing":"idle"),"idle"==m&&p._seekpause&&(m=!1),m&&(a=m,p.attr("data-state",m),setTimeout(o)))},h.media=l,h.player=p,l.on("ended emptied play",function(){var e,t=function(){r=!1},i=function(){n(),l.jmeFn("pause"),d.noReload||!l.prop("ended")||!l.prop("paused")||l.prop("autoplay")||l.prop("loop")||l.hasClass("no-reload")||(r=!0,l.jmeFn("load"),p.attr("data-state","ended"),setTimeout(t))};return function(t){clearTimeout(e),"ended"!=t.type||d.noReload||l.prop("autoplay")||l.prop("loop")||l.hasClass("no-reload")||(e=setTimeout(i))}}()).on("emptied waiting canplay canplaythrough playing ended pause mediaerror",t).on("volumechange updateJMEState",function(){var t=e.prop(this,"volume");p[!t||e.prop(this,"muted")?"addClass":"removeClass"]("state-muted"),t=.01>t?"no":.36>t?"low":.7>t?"medium":"high",p.attr("data-volume",t)}),e.jme.pluginsSel&&p.jmeFn("addControls",e(p[0].querySelectorAll(e.jme.pluginsSel))),t&&l.on("updateJMEState",t).triggerHandler("updateJMEState"))})},e.jme.defineProp("isPlaying",{get:function(t){return!e.prop(t,"ended")&&!e.prop(t,"paused")&&e.prop(t,"readyState")>1&&!e.data(t,"mediaerror")},readonly:!0}),e.jme.defineProp("player",{readonly:!0}),e.jme.defineProp("media",{readonly:!0}),e.jme.defineProp("srces",{get:function(t){var i,n=e.jme.data(t),s=n.media.prop("src");return s?[{src:s}]:i=e.map(e("source",n.media).get(),function(t){var i,n,s={src:e.prop(t,"src")},a=t.attributes;for(i=0,n=a.length;n>i;i++)"specified"in a[i]&&!a[i].specified||(s[a[i].nodeName]=a[i].nodeValue);return s})},set:function(t,i){var n=e.jme.data(t),s=function(t,i){"string"==typeof i&&(i={src:i}),e(document.createElement("source")).attr(i).appendTo(n.media)};return n.media.removeAttr("src").find("source").remove(),e.isArray(i)?e.each(i,s):s(0,i),n.media.jmeFn("load"),"noDataSet"}}),e.jme.defineMethod("togglePlay",function(){e(this).jmeFn(a.isPlaying.get(this)?"pause":"play")}),e.jme.defineMethod("addControls",function(t){var i=e.jme.data(this)||{};if(i.media){var n=e.jme.data(i.player[0],"controlElements")||e([]);t=e(t),e.jme.pluginsSel&&(t=t.find(e.jme.pluginsSel).add(t.filter(e.jme.pluginsSel))),t.length&&(e.each(e.jme.plugins,function(n,s){var a,r,o,l,d=t.filter("."+s.className);for(o=0;o<d.length;o++)if(a=e(d[o]),r=e.jme.data(d[o]),r.player=i.player,r.media=i.media,!r._rendered){if(r._rendered=!0,s.options)for(l in s.options)l in r||(r[l]=s.options[l]);s._create(a,i.media,i.player,r)}}),e.jme.data(i.player[0],"controlElements",n.add(t)),i.player.triggerHandler("controlsadded"))}}),t.ready("DOM mediaelement",function(){t.isReady("jme",!0),t.addReady(e.jme.initJME),t.isReady("jme-base",!0),t.cfg.debug!==!1&&document.getElementsByTagName("video").length&&!document.querySelector(p)&&t.warn("found video element but video wasn't wrapped inside a ."+p+" element. Will not add control UI")})}),webshims.ready("jme-base DOM",function(){"use strict";function e(e){this._data=e,this.lists={},this.on("showcontrolschange",this._updateControlsClass)}function t(e,i,n){this.list=e||[],this.playlists=i,this.media=i._data.media,this.player=i._data.player,this.options=o.extend(!0,{},t.defaults,n),this.options.itemTmpl=this.options.itemTmpl.trim(),this.deferred=o.Deferred(),this._selectedIndex=-1,this._selectedItem=null,this.$rendered=null,this._detectListType(),this.autoplay(this.options.autoplay),this.deferred.done(function(){this._addEvents(this),"auto"!=this.options.defaultSelected||this.media.jmeProp("srces").length||(this.options.defaultSelected=0),this.list[this.options.defaultSelected]&&this.selectedIndex(this.options.defaultSelected),this._fire("addlist")})}function i(e){return e.description=e.description||e.content,e.srces=[],(e.mediaGroups||[]).forEach(function(t){(t.contents||[]).forEach(function(t){t.src=t.src||t.url,e.srces.push(t)})}),e}function n(){return{src:o.attr(this,"href"),srclang:o.attr(this,"lang"),label:o.attr(this,"data-label")}}function s(){return{src:o.attr(this,"url")||o.attr(this,"href"),type:o.attr(this,"type")}}function a(){return 1==this.nodeType}var r=window.webshims,o=r.$,l=o.jme,d=0,p='<button class="{%class%}" type="button" aria-label="{%text%}"></button>';o.extend(e.prototype,{on:function(){o.fn.on.apply(o(this),arguments)},off:function(){o.fn.off.apply(o(this),arguments)},_getListId:function(e){var t;return t="string"==typeof e?e:e.id},_updateControlsClass:function(){this._data.player[this.getShowcontrolsList()?"addClass":"removeClass"]("has-playlist")},add:function(e,i){return e=new t(e,this,i),e.id||(d++,e.id="list-"+d),this.lists[e.id]=e,e.options.showcontrols&&this._data.player.addClass("has-playlist"),e},remove:function(e){var t=this._getListId(e);this.lists[t]&&(this.lists[t]._remove(),delete this.lists[t]),this.getShowcontrolsList()||this._data.player.removeClass("has-playlist")},getAutoplayList:function(){var e=null;return o.each(this.lists,function(t,i){return i.options.autoplay?(e=i,!1):void 0}),e},getShowcontrolsList:function(){var e=null;return o.each(this.lists,function(t,i){return i.options.showcontrols?(e=i,!1):void 0}),e}}),t.getText=function(e){return e.attr("content")||(e.text()||"").trim()},t.getUrl=function(e){return e.attr("content")||e.attr("url")||e.attr("href")||e.attr("src")||(e.text()||"").trim()},t.defaults={loop:!1,autoplay:!1,defaultSelected:"auto",addItemEvents:!0,showcontrols:!0,ajax:{},itemTmpl:'<li class="list-item"><% if(typeof poster == "string" && poster) {%><img src="<%=poster%>" /><% }%><h3><%=title%></h3><% if(typeof description == "string" && description) {%><div class="item-description"><%=description%></div><% }%></li>',renderer:function(e,t){return o.jme.tmpl(t,e)},mapDom:function(e){return{title:t.getText(o('[itemprop="name"], h1, h2, h3, h4, h5, h6, a',e)),srces:o('[itemprop="contentUrl"], a[type^="video"], a[type^="audio"]',e).map(function(){var i,n={src:t.getUrl(o(this))};return i="a"==this.nodeName.toLowerCase()?o.prop(this,"type"):t.getText(o('[itemprop="encodingFormat"]',e)),i&&(n.type=i),i=o.attr(this,"data-media"),i&&(n.media=i),n}).get(),tracks:o('a[type="text/vtt"]').map(n).get(),poster:t.getUrl(o('[itemprop="thumbnailUrl"], a[type^="image"], img',e))||null,description:t.getText(o('[itemprop="description"], .item-description, p',e))||null}},mapUrl:function(e,a){o.ajax(o.extend(e,{success:function(e){var r;o.isArray(e)?r=e:e.responseData&&e.responseData.feed?(e=e.responseData.feed,r=(e.entries||[]).map(i)):(r=[],o("item",e).each(function(){var e=o("enclosure, media\\:content",this).filter('[type^="video"], [type^="audio"]').map(s).get();e.length&&r.push({title:o("title",this).html(),srces:e,publishedDate:o("pubDate",this).html()||null,description:o("description",this).text()||null,poster:t.getUrl(o('itunes\\:image, media\\:thumbnail, enclosure[type^="image"], media\\:content[type^="image"]',this))||null,author:o("itunes\\:author",this).html()||null,duration:o("itunes\\:duration",this).html()||null,tracks:o("media\\:subTitle",this).map(n).get()||null})})),r!=e&&(r.fullData=e),a(r)}}))}},o.extend(t.prototype,{on:function(){o.fn.on.apply(o(this),arguments)},off:function(){o.fn.off.apply(o(this),arguments)},_detectListType:function(){var e;return"string"==typeof this.list?(this._createListFromUrl(),void 0):(this.list.nodeName||this.list.length>0&&this.list[0].nodeName?this._createListFromDom():this.list.responseData&&this.list.responseData.feed&&(e=this.list.responseData.feed,this.list=(e.entries||[]).map(i),this.list.fullData=e),this.deferred.resolveWith(this),void 0)},_createListFromUrl:function(){var e=this;this.options.ajax.url=this.list,this.options.mapUrl(this.options.ajax,function(t){e.list=t,e.deferred.resolveWith(e)})},_createListFromDom:function(){var e=this;this.$rendered=o(this.list).eq(0),this.list=[],this.$rendered&&(this._addDomList(),this.list=this.$rendered.children().map(function(){return e._createItemFromDom(this)}).get())},_createItemFromDom:function(e){var t=this.options.mapDom(e);return this._addItemData(t,e),t},_fire:function(e,t){var e=o.Event(e);o(this).triggerHandler(e,t),o(this.playlists).triggerHandler(e,o.merge([{list:this}],t||[])),this.$rendered&&this.$rendered.triggerHandler(e,t)},_addDomList:function(){this.$rendered.attr({"data-autoplay":this.options.autoplay,"data-loop":this.options.loop}).addClass("media-playlist").data("playlist",this)},_addItemData:function(e,t){var i=this;e.$item=o(t).data("itemData",e),e==this._selectedItem&&e.$item.addClass("selected-item"),this.options.addItemEvents&&e.$item.on("click.playlist",function(t){return i.options.addItemEvents?(i.playItem(e,t),!1):void 0})},_addEvents:function(e){var t=e.options,i=function(i){t.autoplay&&e.playNext(i)};this.media.on("ended",i),this._remove=function(){e.media.off("ended",i),e.autoplay(!1),e.$rendered&&e.$rendered.remove(),e._fire("removelist")}},_remove:function(){this._fire("removelist")},render:function(e){this.$rendered?e(this.$rendered,this.player,this):this.deferred.done(function(){var t,i=this,n=[];if(!this.$rendered){switch(o.each(this.list,function(e,t){var s=o(o.parseHTML(i.options.renderer(t,i.options.itemTmpl))).filter(a)[0];i._addItemData(t,s),n.push(s)}),t=(n[0]&&n[0].nodeName||"").toLowerCase()){case"li":this.$rendered=o.parseHTML("<ul />");break;case"option":this.$rendered=o.parseHTML("<select />");break;default:this.$rendered=o.parseHTML("<div />")}this.$rendered=o(this.$rendered).html(n),this._addDomList()}e(this.$rendered,this.player,this)})},_loadItem:function(e){var t=this.media;t.attr("poster",e.poster||""),o("track",t).remove(),o.each(e.tracks||[],function(e,i){o("<track />").attr(i).appendTo(t)}),e.srces||(e.srces=e),t.jmeProp("srces",e.srces)},_getItem:function(e){return e&&(e.nodeName||e.jquery||"string"==typeof e)&&(e=o(e).data("itemData")),e},playItem:function(e,t){var i;this.selectedItem(e,t),e&&(i=this.media.play(),setTimeout(function(){i.play()},9))},selectedIndex:function(e,t){return arguments.length?(this.selectedItem(this.list[e],t),void 0):this._selectedIndex},selectedItem:function(e,t){var i,n;return arguments.length?(n=-1,e=this._getItem(e),e&&o.each(this.list,function(t){return e==this?(n=t,!1):void 0}),n>=0&&this._loadItem(this.list[n]),n!=this._selectedIndex&&(i=this._selectedItem||null,i&&i.$item&&i.$item.removeClass("selected-item"),this._selectedItem=this.list[n]||null,this._selectedIndex=n,this._selectedItem&&this._selectedItem.$item&&this._selectedItem.$item.addClass("selected-item"),i!==this._selectedItem&&this._fire("itemchange",[{oldItem:i,from:t||null}])),void 0):this._selectedItem},playNext:function(){var e=this.getNext();e&&this.playItem(e)},playPrev:function(){var e=this.getPrev();e&&this.playItem(e)},getNext:function(){var e=this._selectedIndex+1;return this.list[e]||(this.options.loop?this.list[0]:null)},getPrev:function(){var e=this._selectedIndex-1;return this.list[e]||(this.options.loop?this.list[this.list.length-1]:null)}}),[{name:"autoplay",fn:"getAutoplayList"},{name:"showcontrols",fn:"getShowcontrolsList"},{name:"loop"}].forEach(function(e){t.prototype[e.name]=function(t){var i;return arguments.length?(t=!!t,t&&e.fn&&(i=this.playlists[e.fn](),i&&i!=this&&i[e.name](!1)),this.options[e.name]!=t&&(this.options[e.name]=t,this.$rendered&&this.$rendered.attr("data-"+e.name,t),this._fire(e.name+"change")),void 0):this.options[e.name]}}),l.defineProp("playlists",{writable:!1,get:function(t){var i=o.jme.data(t);return t!=i.player[0]?null:(i.playlists||(i.playlists=new e(i)),i.playlists)}}),l.defineMethod("addPlaylist",function(e,t){var i=o.jme.prop(this,"playlists");return i&&i.add?i.add(e,t):null}),[{name:"playlist-prev",text:"previous",get:"getPrev",play:"playPrev"},{name:"playlist-next",text:"next",get:"getNext",play:"playNext"}].forEach(function(e){o.jme.registerPlugin(e.name,{structure:p,text:e.text,_create:function(t,i,n){function s(){var i=r[e.get]();i?t.prop({disabled:!1,title:i.title}):t.prop({disabled:!0,title:""})}function a(){var e=o.getShowcontrolsList();e!=r&&(r&&r.off("itemchange",s),r=e,r&&(r.on("itemchange",s),s()))}var r,o=n.jmeProp("playlists");t.on("click",function(){r&&r[e.play]()}),o.on({"addlist removelist showcontrolschange":a}),a()}})}),function(){var e={};o.jme.tmpl=function(t,i){return e[t]||(e[t]=new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+t.replace(/[\r\t\n]/g," ").replace(/'(?=[^%]*%>)/g,"	").split("'").join("\\'").split("	").join("'").replace(/<%=(.+?)%>/g,"',$1,'").split("<%").join("');").split("%>").join("p.push('")+"');}return p.join('');")),i?e[t](i):e[t]}}(),o.jme.Playlist=t,r.isReady("playlist",!0)});