!function(o){var e=window.webshims;setTimeout(function(){e.isReady("geolocation",!0)});var t=function(){setTimeout(function(){throw"document.write is overwritten by geolocation shim. This method is incompatible with this plugin"},1)},i=0,n=e.cfg.geolocation||{};navigator.geolocation||(navigator.geolocation={}),o.extend(navigator.geolocation,function(){var a,r={getCurrentPosition:function(i,r,c){var s,l,u,d,g=2,m=function(){if(!u)if(a){if(u=!0,i(o.extend({timestamp:(new Date).getTime()},a)),w(),window.JSON&&window.sessionStorage)try{sessionStorage.setItem("storedGeolocationData654321",JSON.stringify(a))}catch(e){}}else r&&!g&&(u=!0,w(),r({code:2,message:"POSITION_UNAVAILABLE"}))},f=function(){g--,y(),m()},w=function(){o(document).off("google-loader",w),clearTimeout(l),clearTimeout(s)},y=function(){if(a||!window.google||!google.loader||!google.loader.ClientLocation)return!1;var e=google.loader.ClientLocation;return a={coords:{latitude:e.latitude,longitude:e.longitude,altitude:null,accuracy:43e3,altitudeAccuracy:null,heading:parseInt("NaN",10),velocity:null},address:o.extend({streetNumber:"",street:"",premises:"",county:"",postalCode:""},e.address)},!0},p=function(){if(!a&&(y(),!a&&window.JSON&&window.sessionStorage))try{a=sessionStorage.getItem("storedGeolocationData654321"),a=a?JSON.parse(a):!1,a.coords||(a=!1)}catch(o){a=!1}};return p(),a?(setTimeout(m,1),void 0):n.confirmText&&!confirm(n.confirmText.replace("{location}",location.hostname))?(r&&r({code:1,message:"PERMISSION_DENIED"}),void 0):(d=function(){o.ajax({url:"http://freegeoip.net/json/",dataType:"jsonp",cache:!0,jsonp:"callback",success:function(o){g--,o&&(a=a||{coords:{latitude:o.latitude,longitude:o.longitude,altitude:null,accuracy:43e3,altitudeAccuracy:null,heading:parseInt("NaN",10),velocity:null},address:{city:o.city,country:o.country_name,countryCode:o.country_code,county:"",postalCode:o.zipcode,premises:"",region:o.region_name,street:"",streetNumber:""}},m())},error:function(){g--,m()}})},o.ajax?d():(e.ready("jajax",d),e.loader.loadList(["jajax"])),clearTimeout(l),window.google&&window.google.loader?g--:l=setTimeout(function(){n.destroyWrite&&(document.write=t,document.writeln=t),o(document).one("google-loader",f),e.loader.loadScript("http://www.google.com/jsapi",!1,"google-loader")},800),s=c&&c.timeout?setTimeout(function(){w(),r&&r({code:3,message:"TIMEOUT"})},c.timeout):setTimeout(function(){g=0,m()},1e4),void 0)},clearWatch:o.noop};return r.watchPosition=function(o,e,t){return r.getCurrentPosition(o,e,t),i++,i},r}()),e.ready("WINDOWLOAD",function(){e.loader.loadList(["jajax"])}),e.isReady("geolocation",!0)}(webshims.$);