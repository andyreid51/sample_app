webshims.register("jmebase",function(e,t,n,a,i){"use strict";var o={},r={},d=Array.prototype.slice,s=0,l=e.extend({selector:".mediaplayer"},t.cfg.mediaelement.jme),p=l.selector;t.cfg.mediaelement.jme=l,e.jme||(e.jme={}),e.extend(e.jme,{pluginsClasses:[],pluginsSel:"",plugins:{},props:o,fns:r,data:function(t,n,a){var o=e(t).data("jme")||e.data(t,"jme",{});return a===i?n?o[n]:o:(o[n]=a,void 0)},runPlugin:function(t){s&&e(document.querySelectorAll(p)).each(function(){var n=this.querySelectorAll(t);n.length&&e(this).jmeFn("addControls",n)})},registerPlugin:function(t,n){this.plugins[t]=n,n.nodeName||(n.nodeName=""),n.className||(n.className=t),this.pluginsClasses.push("."+n.className),this.pluginsSel=this.pluginsClasses.join(", "),l[t]=e.extend(n.options||{},l[t]),l[t]&&l[t].text?n.text=l[t].text:l.i18n&&l.i18n[t]&&(n.text=l.i18n[t]),this.runPlugin("."+n.className)},configmenuPlugins:{},addToConfigmenu:function(e,t){this.configmenuPlugins[e]=t},defineMethod:function(e,t){r[e]=t},defineProp:function(t,n){n||(n={}),n.set||(n.set=n.readonly?function(){throw t+" is readonly"}:e.noop),n.get||(n.get=function(n){return e.jme.data(n,t)}),o[t]=n},prop:function(t,n,a){if(!o[n])return e.prop(t,n,a);if(a===i)return o[n].get(t);var r=o[n].set(t,a);r===i&&(r=a),"noDataSet"!=r&&e.jme.data(t,n,r)}}),e.fn.jmeProp=function(t,n){return e.access(this,e.jme.prop,t,n,arguments.length>1)},e.fn.jmeFn=function(n){var a,o=d.call(arguments,1);return this.each(function(){return e.jme.data(this).media||(e(this).closest(p).jmePlayer(),t.warn("jmeFn called to early or on wrong element!")),a=(r[n]||e.prop(this,n)).apply(this,o),a!==i?!1:void 0}),a!==i?a:this};var u={emptied:1,pause:1},m={canplay:1,canplaythrough:1};e.jme.initJME=function(t,n){s+=e(t.querySelectorAll(p)).add(n.filter(p)).jmePlayer().length},e.jme.getDOMList=function(t){var n=[];return t||(t=[]),"string"==typeof t&&(t=t.split(" ")),e.each(t,function(e,t){t&&(t=document.getElementById(t),t&&n.push(t))}),n},e.jme.getButtonText=function(t,n){var a,i,o=function(o){i!==o&&(i=o,t.removeClass(n[o?0:1]).addClass(n[o]),a&&(t.prop("checked",!!o),(t.data("checkboxradio")||{refresh:e.noop}).refresh()))};return t.is('[type="checkbox"], [type="radio"]')?(t.prop("checked",function(){return this.defaultChecked}),a=!0):t.is("a")&&t.on("click",function(e){e.preventDefault()}),o},e.fn.jmePlayer=function(){return this.each(function(){var t,n,a,i,o,r,d,s=e("audio, video",this).eq(0),p=e(this),c=e.jme.data(this),f=e.jme.data(s[0]);p.addClass(s.prop("nodeName").toLowerCase()+"player"),f.player=p,f.media=s,c.media||(d=function(){p[0].className=p[0].className},a=function(){s.off("canplay",n),clearTimeout(i)},n=function(){var e=s.prop("paused")?"idle":"playing";p.attr("data-state",e)},t=function(t){var l,c,f=t.type;a(),m[f]&&"waiting"!=o||r&&"emptied"==f||("ended"==f||e.prop(this,"ended")?f="ended":"waiting"==f?e.prop(this,"readyState")>2?f="":(i=setTimeout(function(){s.prop("readyState")>2&&n()},9),s.on("canPlay",n)):u[f]?f="idle":(l=e.prop(this,"readyState"),c=e.prop(this,"paused"),f=!c&&3>l?"waiting":!c&&l>2?"playing":"idle"),"idle"==f&&p._seekpause&&(f=!1),f&&(o=f,p.attr("data-state",f),setTimeout(d)))},c.media=s,c.player=p,s.on("ended emptied play",function(){var e,t=function(){r=!1},n=function(){a(),s.jmeFn("pause"),l.noReload||!s.prop("ended")||!s.prop("paused")||s.prop("autoplay")||s.prop("loop")||s.hasClass("no-reload")||(r=!0,s.jmeFn("load"),p.attr("data-state","ended"),setTimeout(t))};return function(t){clearTimeout(e),"ended"!=t.type||l.noReload||s.prop("autoplay")||s.prop("loop")||s.hasClass("no-reload")||(e=setTimeout(n))}}()).on("emptied waiting canplay canplaythrough playing ended pause mediaerror",t).on("volumechange updateJMEState",function(){var t=e.prop(this,"volume");p[!t||e.prop(this,"muted")?"addClass":"removeClass"]("state-muted"),t=.01>t?"no":.36>t?"low":.7>t?"medium":"high",p.attr("data-volume",t)}),e.jme.pluginsSel&&p.jmeFn("addControls",e(p[0].querySelectorAll(e.jme.pluginsSel))),t&&s.on("updateJMEState",t).triggerHandler("updateJMEState"))})},e.jme.defineProp("isPlaying",{get:function(t){return!e.prop(t,"ended")&&!e.prop(t,"paused")&&e.prop(t,"readyState")>1&&!e.data(t,"mediaerror")},readonly:!0}),e.jme.defineProp("player",{readonly:!0}),e.jme.defineProp("media",{readonly:!0}),e.jme.defineProp("srces",{get:function(t){var n,a=e.jme.data(t),i=a.media.prop("src");return i?[{src:i}]:n=e.map(e("source",a.media).get(),function(t){var n,a,i={src:e.prop(t,"src")},o=t.attributes;for(n=0,a=o.length;a>n;n++)"specified"in o[n]&&!o[n].specified||(i[o[n].nodeName]=o[n].nodeValue);return i})},set:function(t,n){var a=e.jme.data(t),i=function(t,n){"string"==typeof n&&(n={src:n}),e(document.createElement("source")).attr(n).appendTo(a.media)};return a.media.removeAttr("src").find("source").remove(),e.isArray(n)?e.each(n,i):i(0,n),a.media.jmeFn("load"),"noDataSet"}}),e.jme.defineMethod("togglePlay",function(){e(this).jmeFn(o.isPlaying.get(this)?"pause":"play")}),e.jme.defineMethod("addControls",function(t){var n=e.jme.data(this)||{};if(n.media){var a=e.jme.data(n.player[0],"controlElements")||e([]);t=e(t),e.jme.pluginsSel&&(t=t.find(e.jme.pluginsSel).add(t.filter(e.jme.pluginsSel))),t.length&&(e.each(e.jme.plugins,function(a,i){var o,r,d,s,l=t.filter("."+i.className);for(d=0;d<l.length;d++)if(o=e(l[d]),r=e.jme.data(l[d]),r.player=n.player,r.media=n.media,!r._rendered){if(r._rendered=!0,i.options)for(s in i.options)s in r||(r[s]=i.options[s]);i._create(o,n.media,n.player,r)}}),e.jme.data(n.player[0],"controlElements",a.add(t)),n.player.triggerHandler("controlsadded"))}}),t.ready("DOM mediaelement",function(){t.isReady("jme",!0),t.addReady(e.jme.initJME),t.isReady("jme-base",!0),t.cfg.debug!==!1&&document.getElementsByTagName("video").length&&!document.querySelector(p)&&t.warn("found video element but video wasn't wrapped inside a ."+p+" element. Will not add control UI")})});